2026-02-06 15:51 - Scaffolded frontend module folders and README structure
2026-02-06 15:51 - Scaffolded backend module folders and README structure
2026-02-06 15:51 - Created initial Supabase migrations (schema, RLS, views)
2026-02-06 15:51 - Refined migrations for FK order and spec-aligned views
2026-02-06 15:51 - Confirmed initial migrations have been run
2026-02-06 15:56 - Added seed migration for locations and currencies
2026-02-06 15:57 - Added seed migration for app settings defaults
2026-02-06 16:27 - Added locations ingestion support and raw backfill migrations
2026-02-06 16:29 - Added full raw locations seed from Salesforce export
2026-02-06 16:31 - Regenerated raw locations seed to fix country_code
2026-02-06 16:33 - Confirmed location/app settings seed imports completed
2026-02-06 16:41 - Parsed project spec into goals/docs and updated READMEs
2026-02-06 17:05 - Created backend foundation action plan for Phase 1
2026-02-06 17:12 - Audited Kaptio-focused action plan against goals
2026-02-06 18:05 - Implemented backend foundation and Kaptio MVP read APIs
2026-02-06 18:22 - Audited Kaptio MVP and refined cashflow calculations
2026-02-06 18:35 - Created backend contract freeze action plan and sample payloads doc
2026-02-06 18:41 - Audited contract freeze plan against goals
2026-02-07 08:30 - Implemented contract freeze updates, tests, and docs
2026-02-07 08:33 - Marked backend contract freeze plan complete
2026-02-07 08:44 - Created frontend foundation action plan
2026-02-07 08:46 - Expanded frontend plan for full navigation scope
2026-02-07 09:00 - Scaffolded SwainOS frontend foundation and docs
2026-02-07 09:06 - Hardened frontend scaffold (gitignore, error handling, types)
2026-02-07 12:46 - Initialized Next.js config and marked frontend plan complete
2026-02-07 12:51 - Added Supabase public env configuration for frontend
2026-02-07 13:16 - Renamed salesforce_id to external_id across schema and backend
2026-02-07 13:22 - Created historical data import action plan
2026-02-07 13:42 - Added contacts schema shift migration and updated plans
2026-02-07 14:00 - Updated data import plan for contact_type values
2026-02-07 14:15 - Added agencies consortia field and updated import plan
2026-02-07 19:19 - Replaced booking_status with is_deleted and updated imports
2026-02-09 13:10 - Added backend .env scaffold for Supabase settings
2026-02-09 13:13 - Updated data import plan for REST upsert ingestion
2026-02-09 13:30 - Added REST upsert script for bookings load
2026-02-09 19:33 - Completed bookings REST upsert resume after UUID cleanup
2026-02-09 19:40 - Added migration to drop itinerary_items.quantity
2026-02-09 19:45 - Added migration to restore itinerary_items.quantity
2026-02-09 19:52 - Added REST upsert script for itinerary items
2026-02-09 20:50 - Completed itinerary_items REST upsert
2026-02-09 20:56 - Added card_type to customer_payments schema
2026-02-09 21:02 - Added REST upsert script for customer payments
2026-02-09 21:03 - Completed customer_payments REST upsert
2026-02-09 21:08 - Refreshed backend/frontend docs and data import plan state
2026-02-09 21:14 - Created frontend initial buildout action plan
2026-02-09 21:21 - Audited and aligned frontend buildout plan to spec
2026-02-10 01:31 - Set up backend venv and started local API server
2026-02-10 13:32 - Completed frontend initial buildout implementation, contract alignment, and local run verification
2026-02-10 13:39 - Refined frontend visual system, removed remaining hardcoded metrics, and consolidated command center data flow
2026-02-10 14:25 - Audited itinerary trend flow, aligned trend aggregation to materialized view, and refreshed frontend trend summaries
2026-02-10 14:45 - Fixed Command Center loading (resilient fetch + backend fallback for missing mv_itinerary_trends); added FX Command with live rates, exposure (live or mock), and best-time-to-buy UI
2026-02-10 14:52 - Created FX backend action plan for live rates, exposure, trade logging, AI insights, and forecasts
2026-02-10 14:55 - Scoped FX to supplier currencies only: ZAR, USD, AUD, NZD (backend filter for rates and exposure; frontend mock and copy updated)
2026-02-10 14:57 - Replaced module placeholders with full UI shells for Debt Service, Operations, AI Insights, and Settings; updated frontend buildout plan status and docs
2026-02-10 14:59 - Completed frontend initial buildout plan: lint clean, QA complete, plan marked ✅ COMPLETED
2026-02-10 15:24 - Updated sample payloads for FX scope and added frontend data queries document
2026-02-10 16:06 - Created itinerary status pipeline action plan (status-driven trends + filters)
2026-02-10 16:11 - Implemented itinerary pipeline backend (mv_itinerary_status_trends migration, API route, docs and sample payloads)
2026-02-10 16:16 - Cleaned backend artifacts, added backend .gitignore, and aligned README structure notes
2026-02-10 16:17 - Updated itinerary status pipeline plan status and backend docs to current backend completion state
2026-02-10 16:24 - Added migration to remove closed_count usage and add period_end to status trends; updated docs/sample payloads
2026-02-10 16:24 - Updated itinerary status pipeline plan to reflect migrations applied and backend complete
2026-02-10 16:28 - Implemented itinerary pipeline frontend (status cards, stacked trend, detail table) and updated docs
2026-02-10 16:40 - Reorganized frontend structure: moved route UIs to features, promoted shared UI components, removed unused services/types, and ignored build artifacts
2026-02-10 16:43 - Marked itinerary status pipeline plan complete and updated frontend docs for shared UI organization
2026-02-10 16:47 - Updated itinerary pipeline view to line chart + horizontal matrix table for clarity
2026-02-10 16:59 - Added migration to base itinerary status trends on travel_start_date and updated backend docs
2026-02-10 16:43 - Verified UI loads in browser with existing dev servers running
2026-02-10 16:13 - Reviewed SwainOS backend folder structure for organization and alignment
2026-02-10 16:31 - Audited SwainOS frontend structure for organization and naming
2026-02-10 17:12 - Added stage-based itinerary pipeline view (new mv_itinerary_pipeline_stages, close-ratio forecast fields, updated UI + docs)
2026-02-10 17:24 - Switched pipeline trend chart to stacked bars and capped close ratio at 100%
2026-02-10 17:34 - Fixed pipeline chart scaling so monthly bars render across the full axis
2026-02-10 17:42 - Updated monthly pipeline chart to gross-amount bars for Confirmed/Quoted/Traveling/Traveled only
2026-02-10 17:51 - Added compact gross-amount labels atop monthly pipeline bars
2026-02-10 18:02 - Reworked pipeline matrix to show gross/net/margin across months for core stages
2026-02-10 18:16 - Added gross/net chart toggle, redesigned monthly pipeline table, and revised close-ratio formula for interpretability
2026-02-10 18:24 - Switched itinerary pipeline API to forward window (current month onward) and updated UI copy
2026-02-10 18:39 - Added pipeline pax rollups and rebuilt UI around forward on-books/potential/expected forecast trend + outlook table
2026-02-11 11:40 - Added itinerary enrichment migration + status reference + monthly revenue/deposit rollups, created itinerary upsert script, and documented itinerary ETL mapping
2026-02-11 11:55 - Audited and hardened itinerary enrichment migration with pipeline buckets, weekly/consortia/trade-agency rollups, and external-id bridge fields
2026-02-11 12:03 - Added itinerary upsert FK resolver (external_id -> UUID for agency/contact) and documented resolver behavior
2026-02-11 12:17 - Ran itinerary REST upsert from latest CSV (215 batches) and validated close_date population post-import
2026-02-11 12:44 - Implemented owner-cockpit itinerary revenue APIs/UI, deprecated old pipeline/revenue endpoints, and updated docs/contracts
2026-02-11 17:26 - Audited owner-cockpit refactor, fixed weekly rollup query mismatch, started backend/frontend, and verified revenue-bookings UI in browser
2026-02-11 17:44 - Stacked channel tables, added share + reseller commission metrics, and added migration to fix trade-agency rollup classification/fallbacks
2026-02-11 18:18 - Split Revenue & Bookings into Itinerary Forecast + Itinerary Actuals, added actuals-yoy API/UI, and refreshed docs/query inventory
2026-02-11 18:39 - Simplified side nav labels, added lead-flow tracking to forecast/actuals, fixed actuals to 4-year YoY variance view, and removed legacy forecast dead code
2026-02-11 18:57 - Added closed-won actuals channel rollups/API and wired Top consortia/trade production panels into Itinerary Actuals
2026-02-11 19:12 - Audited/cleaned nav + UI, removed metric definition callouts, added collapsible icon nav, and refreshed backend/frontend/query docs for actuals channels
2026-02-11 19:28 - Completed tech-debt cleanup pass, removed unused nav description metadata, and normalized code documentation docs to current-state format
2026-02-11 19:41 - Refined Itinerary Actuals owner comparison UX: fixed 3-year scope, added channel period toggles, and added current-vs-last-year production snapshot
2026-02-11 19:49 - Ensured Itinerary Actuals always renders a 3-year matrix (including zero-data baseline year) and improved YoY baseline labeling
2026-02-11 20:15 - Diagnosed actuals UI gap to query-param alias mismatch, enforced snake_case filters in itinerary-revenue API, and verified years_back/actuals_year now apply correctly
2026-02-11 20:34 - Reframed itinerary Forecast/Actuals metrics around Commission Income (Gross - Itinerary Cost), defaulted toggles to Income, and updated charts/tables from Net to Commission Income labels
2026-02-11 21:08 - Added commission_income rollup migration, refactored backend/front-end itinerary revenue contracts to commissionIncomeAmount, and validated API outputs match gross minus cost
2026-02-11 21:22 - Completed technical-debt audit pass: removed legacy net fallbacks in itinerary-revenue repo/service, revalidated API commissionIncome fields, and reran frontend lint/build
2026-02-11 21:36 - Redesigned Itinerary Actuals YoY trend chart with stronger visual contrast, per-month datapoint markers, Jan/Jun/Dec value labels, and multi-level gridlines for readability
2026-02-11 21:52 - Added per-bar value labels to shared itinerary lead-flow bar chart for clearer month-by-month readability
2026-02-11 22:01 - Enhanced lead-flow bar labels with responsive behavior: compact values + every-other label on small screens, full labels on medium+
2026-02-11 22:18 - Completed consistency audit pass: moved legacy forecast panels out of deprecated revenue-bookings folder, removed stale files, and synchronized backend/frontend/payload/query mapping docs to current contracts
2026-02-12 09:27 - Corrected deposit health window/source semantics, added conversion commission-income best/base/worst projections, and fixed YoY Jan/Dec datapoint clipping
2026-02-12 09:36 - Added month-by-month Trade vs Direct production (consortia Not Applicable = direct) with totals to itinerary actuals API/UI
2026-02-12 09:46 - Reclassified Cancelled and Amendment Merged to closed_lost via migration and updated itinerary data-mapping status table
2026-02-12 09:50 - Converted Trade vs Direct section into a compact vertical 2-year matrix with per-year totals
2026-02-12 10:07 - Fixed YoY month-label alignment, upgraded forecast to true multi-line chart with monthly datapoints, moved Jan-Dec matrix below YoY, and rebuilt trade production as Jan-Dec MoM matrix
2026-02-12 10:24 - Added shared project Cursor skill (.cursor/skills/quality-audit-pass) for standardized code quality audit prompts
2026-02-12 11:01 - Added migration to source commission-income from gross_profit and enforce closed-won allowlist; updated forecast/actuals UI labels and synced backend/frontend/query/payload mapping docs
2026-02-12 11:07 - Confirmed recent commission-income/closed-won migration was run in Supabase and aligned forecast + lead-flow UI comparisons to the updated model
2026-02-12 11:19 - Added dedicated itinerary lead-flow rollup/API (created_at cohorts with closed_won/closed_lost conversion) and wired forecast/actuals lead panels to YoY lead conversion metrics
2026-02-12 11:20 - Fixed lead-flow migration join to use itinerary_status_reference.status_value after SQL error on missing status_label column
2026-02-12 13:38 - Ran quality-audit-pass on lead-flow rollout and hardened migration with normalized status join + period_start index for stable mapping/perf
2026-02-12 13:53 - Fixed lead-flow month label timezone shift (Jan/Feb off-by-one) and aligned forecast chart x-axis labels directly to plot coordinates for responsive accuracy
2026-02-12 13:55 - Standardized UTC-safe month label parsing across itinerary forecast/actuals tables to prevent cross-timezone month shifts
2026-02-12 13:59 - Replaced brittle forecast SVG line chart with responsive stacked scenario bars (on-books + expected uplift + upside uplift) and validated lint/build
2026-02-12 14:05 - Reviewed itinerary forecast/actuals readability and upgraded Command Center with itinerary forecast, lead conversion, deposit coverage, and latest actuals gross-profit KPIs
2026-02-12 14:16 - Added historical forecast + 12% YoY target rollup to itinerary outlook API and updated forecast graph/table to show On Books, Expected, Forecast, and Target
2026-02-12 14:22 - Refined outlook expected-close logic with blended stage+bucket conversion ratio bounds and added per-series monthly data labels to forecast bars
2026-02-12 14:34 - Reverted cluttered forecast labels and migrated outlook chart to responsive Recharts grouped bars with readable tooltip/legend
2026-02-12 14:48 - Removed remaining custom itinerary charts (YoY trend and lead-flow mini chart) in favor of responsive Recharts components and validated lint
2026-02-12 15:02 - Audited itinerary forecast/actuals recent chart changes, confirmed no active diagnostics, and removed leftover unused outlook chart computations
2026-02-12 15:21 - Ran objective forecast/actuals anti-slop pass: centralized UTC month formatting utility, removed duplicated date helpers, and optimized trade-vs-direct monthly bucketing
2026-02-12 15:34 - Consolidated itinerary forecast/actuals UI controls and KPI presentation with shared SegmentedToggle + KpiStatCard components and revalidated lint/build
2026-02-12 15:13 - Initialized git repos for frontend/backend/docs, connected GitHub remotes, and pushed main branches to protect current project state
2026-02-12 15:15 - Refreshed frontend/backend READMEs, added documentation repo README, and pushed updates to keep repo onboarding docs current
2026-02-12 15:46 - Audited backend folder organization, confirmed flat repository/service layout is intentional, and removed unused src/schemas/salesforce.py
2026-02-12 16:02 - Completed strict backend dead-code and structure cleanup: removed unused pipeline/revenue schema symbols, removed UnauthorizedError, and deleted 34 empty legacy src directories
2026-02-13 09:30 - Compiled comprehensive API key and environment variable checklist across spec, backend, and frontend docs
2026-02-15 20:29 - Created Travel Consultant analytics bible action plan with KPI contract, employee schema, attribution strategy, and phased rollout
2026-02-16 07:08 - Audited Travel Consultant analytics action plan and tightened spend-source, compensation, attribution enforcement, and access-control requirements
2026-02-16 08:44 - Performed second audit pass to enforce existing rollup/UI reuse, Supabase naming consistency, and query optimization guardrails in Travel Consultant plan
2026-02-16 08:47 - Final audit pass fixed query-param snake_case and aligned Supabase index naming convention with existing idx_* migration style
2026-02-16 09:52 - Implemented Travel Consultant backend foundation: employees schema/migrations, itinerary owner resolver, consultant APIs/services/repositories, and updated backend payload/docs
2026-02-16 10:09 - Ran deep pre-migration audit and hardened RLS/FK behavior plus backend consolidation cleanup for travel consultant rollout
2026-02-16 11:56 - Imported travel consultant employee CSV (186 rows) with duplicate-email filtering and BOM-safe header handling
2026-02-16 12:43 - Updated travel consultant action plan/docs to current backend-complete state and completed final consistency audit before push
2026-02-16 14:05 - Implemented Travel Consultant frontend routes/modules, wired navigation, and synced consultant query/mapping documentation
2026-02-16 13:05 - Diagnosed Travel Consultant loading hang, hardened backend settings env parsing, fixed Next.js dynamic params usage, and validated leaderboard/profile live in browser
2026-02-16 13:11 - Added Travel Consultant This Year mode, consultant search UX, horizontal YoY matrix, and operational snapshot (current traveling files + top open itineraries) with backend/profile contract updates
2026-02-16 13:14 - Refined consultant leaderboard to average-first KPIs and added explicit YoY-to-date variance metrics with funnel-vs-travel date-basis clarity
2026-02-16 13:17 - Ran full quality-audit pass, fixed open-itinerary status filtering robustness, and corrected profile YoY matrix month rendering to match selected comparison window
2026-02-16 13:19 - Tightened operational snapshot to status=Traveling files only and added profile YTD variance KPI in Forecast and Target
2026-02-16 13:22 - Replaced profile Trend Story with 3-year monthly matrices (closed travel files + lead funnel) including year-over-year variance rows
2026-02-16 13:24 - Switched speed-to-book metrics from median to average across API/service calculations and frontend labels
2026-02-16 13:25 - Stacked 3-year performance matrix cards vertically on consultant profile for cleaner readability
2026-02-16 13:27 - Improved 3-year matrix responsiveness and switched both matrices to revenue-based monthly values with YoY variance rows
2026-02-16 13:28 - Unnested 3-year matrices into separate full-width profile cards to maximize table display space
2026-02-16 13:41 - Implemented advisor-effectiveness UX pass across leaderboard/profile: summary strips, clearer funnel denominators, explicit profile CTA, deduped insight narrative, and compensation not-set clarity
2026-02-16 13:50 - Added mobile breakpoint optimization for leaderboard density by prioritizing core columns and deferring lower-priority columns to larger widths
2026-02-16 13:53 - Expanded profile Hero KPIs with new advisor averages (gross profit, itinerary nights, group size, lead time, speed to close) and aligned backend metric calculations
2026-02-16 13:54 - Reformatted forecast Period labels to readable month-year text for faster scanning on consultant profile
2026-02-16 13:58 - Completed full quality-audit-pass and synchronized Travel Consultant action plan plus frontend/query/mapping/sample docs to current shipped contract and UX
2026-02-16 14:01 - Standardized consultant 3-year matrix styling to itinerary-actuals format with inline directional indicators and renamed completed plan file with -completed suffix
2026-02-16 16:05 - Added inactive-employee cleanup script with dry-run/apply modes and validated 2-year itinerary activity candidate set
2026-02-16 16:07 - Executed inactive-employee cleanup apply run; deleted 168 employees and verified only 18 active-in-window records remain
2026-02-16 16:21 - Fixed consultant 3-year matrices to render newest year first and correctly show monthly YoY arrow indicators versus prior year
2026-02-16 17:11 - Fixed top-open-itineraries query window to avoid undercount; now returns true top 5 open/holding statuses by gross amount
2026-02-17 06:50 - Replaced profile Hero KPI Average Lead Time with Commission Income and removed unused lead-time calculation path
2026-02-17 06:53 - Added subtle hover definitions on profile Hero KPI labels and reordered KPI sequence to place Commission Income immediately after Booked Revenue
2026-02-17 07:54 - Added profile commission-income YoY monthly line chart below Hero KPIs using travel-date monthly commission series from backend profile payload
2026-02-17 08:33 - Fixed profile runtime null-access bug for commission trend memo and performed clean backend/frontend restart with healthy Travel Consultant profile/API verification
2026-02-17 08:35 - Replaced monthly commission chart with cumulative YTD pace chart plus YTD comparison KPIs to benchmark current commission run-rate versus prior years
2026-02-17 08:37 - Enhanced commission YTD section with month-labeled chart axis and detailed monthly comparison table (current/prior, monthly delta, and cumulative YTD delta)
2026-02-17 08:39 - Simplified commission section to a single standard cumulative YTD line chart (current vs prior year) with 12% target pace overlay; removed added monthly table per UX feedback
2026-02-17 08:42 - Deprecated and fully removed consultant commission YTD graph feature from profile UI and API contract to simplify experience per feedback
2026-02-16 14:17 - Created backend-first AI-native insights action plan with travel consultant embeds and cross-domain scaling contract
2026-02-16 14:32 - Audited AI-native insights plan and locked snake_case lifecycle statuses plus canonical scheduler path (scripts/generate_ai_insights.py)
2026-02-16 15:29 - Implemented AI insights backend+Supabase foundation (migrations, services, APIs, manual trigger script, tests, and docs updates)
2026-02-16 15:36 - Remediated AI audit findings: fixed manual script bootstrap, secured run endpoint token gate, linked recommendation->insight events, and added numeric cast migration for command-center conversion rate
2026-02-16 15:55 - Implemented AI frontend buildout: live AI Insights page, command-center briefing integration, travel-consultant AI embeds, assistant entity grounding, and docs/query sync
2026-02-16 15:59 - Remediated frontend audit risks: added AI fetch race guards, filter pagination resets, partial-data warnings, assistant context cleanup, and status label UX polish
2026-02-16 16:08 - Purged stale AI outputs after inactive-employee cleanup and regenerated insights from cleaned employee data
2026-02-16 16:14 - Hardened AI and travel-consultant pipelines to exclude deleted employees, then purged/regenerated AI outputs with zero orphan employee references
2026-02-16 16:18 - Added consultant+AI rollup refresh RPC/script, refreshed materialized views to remove orphan employee snapshots, and reran AI purge/regeneration with validated YTD/year/rolling travel-vs-funnel outputs
2026-02-16 16:26 - Aligned AI consultant context to Travel Consultant leaderboard rolling-12 KPI logic, regenerated AI outputs, and verified exact conversion parity between AI recommendations and leaderboard metrics
2026-02-16 16:33 - Expanded AI consultant context with monthly/year/rolling12 snapshots, travel-vs-funnel deltas, and YoY-to-date tags; regenerated outputs and verified tagged summaries with canonical source lineage
2026-02-16 16:35 - Removed verbose window-tag dump from AI card summaries, switched to concise manager-grade rolling12 KPI summaries, and regenerated AI outputs for clean UI readability
2026-02-16 16:38 - Refined AI recommendation cards into manager brief format (headline status, KPI chips, trend line, owner/timebox action, Why drawer) and expanded backend evidence metrics for conversion/margin/YoY/trend deltas
2026-02-16 16:44 - Switched consultant recommendation summary source to AI narrative output, hardened confidence parsing, added OpenAI model failover to gpt-4o/gpt-4o-mini, and regenerated insights with live manager-readable analysis
2026-02-16 16:48 - Re-aligned AI consultant actionability to canonical rolling12 benchmarks (dynamic target thresholds + volume gates), fixed evidence unit coverage, and validated recommendation margin/conversion parity against Travel Consultant leaderboard
2026-02-16 16:50 - Enforced metric-anchored AI coaching narratives with explicit team-average/threshold/strategic-target comparisons in summaries and regenerated recommendation outputs
2026-02-16 17:01 - Added benchmark/company AI rollup migrations, updated refresh RPC contract, wired orchestration to Supabase benchmark rollups (replacing runtime-only benchmark dependency), and validated benchmark context lineage in generated coaching insights
2026-02-16 17:03 - Removed gpt-4o fallback path from AI orchestration model routing, set GPT-5.2 decision default, and reran AI generation with verified GPT-5.2 decision-tier outputs
2026-02-16 17:06 - Tightened consultant coaching prompt/output normalization for clear individual-person summaries (name-first, concise two-sentence format, single benchmark comparison) and regenerated AI recommendations for focus-oriented readability
2026-02-16 17:10 - Completed objective output-quality pass, enforced consultant name in recommendation titles, tightened action length/word-boundary normalization, purged historical mixed outputs, and regenerated a clean focused recommendation set
2026-02-16 17:13 - Completed deep thread-wide quality audit, removed dead legacy summary helper, simplified model routing logic, and updated backend/frontend documentation with benchmark rollups and GPT-5.2-only routing details
2026-02-16 17:19 - Normalized command-center briefing highlight/action formatting to prevent raw object dumps, enforced concise plain-text list constraints, and regenerated AI outputs with cleaned UI-readable briefing cards
2026-02-16 18:16 - Added executive-grade AI UI polish with reusable expandable text + max-3 briefing bullets and view-more expanders, split diagnosis/action blocks on insights cards, fixed client runtime normalization bug, and revalidated regenerated outputs in browser
2026-02-16 18:53 - Simplified executive readability pass: resolved owner labels to names when available via consultant profile lookups, added subtle diagnosis/action visual cues, applied viewport-aware summary truncation, and kept fallback labels concise with no raw ID exposure
2026-02-16 19:06 - Added always-on frontend Cursor rule to avoid useEffect by default and follow React alternatives-first guidance
2026-02-16 20:17 - Completed full thread audit and cleanup pass, removed lint risk in AI owner-name resolution effect, simplified responsive truncation props, and updated action plan + backend/frontend query/payload docs with aligned TOCs and current AI architecture state
2026-02-16 20:28 - Added employees.analysis_disabled analytics opt-out control, updated itinerary/consultant rollups and refresh RPC to exclude disabled employees across reporting + AI contexts, and updated backend/query docs for checkbox-driven refresh workflow
2026-02-16 20:31 - Refined analysis_disabled scope to consultant-only analytics exclusion (consultant rollups + consultant AI context) and preserved itinerary/forecast/revenue company reporting behavior
2026-02-16 20:37 - Fixed migration dependency order for consultant-only analysis_disabled rollout by dropping/rebuilding dependent AI context materialized views before consultant rollup recreates
2026-02-16 21:02 - Corrected action-log timestamp ordering so entries remain strictly chronological with newest updates appended last.
2026-02-17 09:44 - Simplified AI Insights page navigation with Focus/Explore/History modes, reduced default filter complexity, and made action-first workflow the default view.
2026-02-17 09:57 - Renamed AI-native insights action plan to completed naming convention and refreshed plan metadata/current-state to reflect final implemented UI flow.
2026-02-17 10:00 - Normalized legacy action-plan filenames from '-complete' to '-completed' and verified there are no remaining '-complete.md' references.
2026-02-17 06:21 - Created platform performance optimization action plan covering backend/frontend/Supabase load-time and processing efficiency fixes.
2026-02-17 06:31 - Upgraded performance optimization plan with modern architecture guardrails, explicit budgets, count-cost strategy, and anti-overengineering non-goals.
2026-02-17 06:32 - Updated optimization plans to enforce technical-debt removal and no-backward-compatibility replacement policy for internal legacy paths.
2026-02-17 06:40 - Implemented platform performance optimization pass: removed duplicate consultant forecast fetch, added request dedupe/cache + progressive loading, reduced backend query fan-out, and made AI exact counts opt-in.
2026-02-17 06:42 - Completed ruthless audit remediation: fixed command-center loading-state bug, removed standalone performance metrics doc, and folded optimization notes into primary backend/frontend documentation.
2026-02-17 06:43 - Tightened AI pagination quality by switching non-exact totals to PostgREST planned counts instead of synthetic totals.
2026-02-17 06:44 - Rewrote backend/frontend code documentation wording to current-state language and removed change-log phrasing.
2026-02-17 06:48 - Completed final quality-audit pass and converted plan 10 to completed-state file (`-completed`) with current implementation outcomes.
2026-02-17 06:55 - Reorganized frontend sidebar navigation into grouped sections: top-level overview links, Sales and Finance child nav groups, and standalone Operations/Settings entries.
2026-02-17 07:51 - Fixed sidebar child-link rendering bug by making nav links full-width blocks and applying a stable, readable active style for section child items.
2026-02-17 08:49 - Added terminology governance rollout plan, created canonical glossary, and linked glossary in frontend/backend code documentation.
2026-02-17 09:07 - Completed breaking terminology rollout for Gross Profit naming across backend schemas/services, frontend contracts/UI, AI wording normalization, and core contract docs/sample payloads.
2026-02-17 09:16 - Added Supabase migration 0047 to rename rollup/context columns from commission-income to canonical gross-profit and updated refresh RPC coverage.
2026-02-17 09:30 - Verified 0047 rollout in runtime DB: canonical gross-profit columns active, legacy commission-income columns removed, and AI generation script completed successfully.
2026-02-17 09:40 - Completed quality-audit pass and NaN hardening: normalized raw itinerary/lead/forecast API numerics across frontend services and removed unsafe fallback casting tech debt.
2026-02-17 10:18 - Created backend-first Travel Agency + Travel Agent analytics action plan with Supabase rollup strategy, consultant-parity API contracts, and full frontend rollout scope.
2026-02-17 10:22 - Ran first-principles quality audit on plan 12; removed contract unknowns, locked deterministic tie-break rules, and hardened Supabase refresh/search optimization strategy.
2026-02-17 11:24 - Implemented travel trade analytics rollout: migration 0048 + refresh script, backend travel-agent/agency/search APIs, frontend Travel Agencies routes/charts, and documentation/query/payload updates.
2026-02-17 11:58 - Applied heavy corrective pass for travel trade rollout: added migration 0049 to harden refresh function against schema drift, include Not Applicable consortia classification, stabilize agent-assignment history, seed rollups immediately, and fixed ranking/search/composition behaviors.
2026-02-17 12:09 - Fixed 0049 refresh failure on contacts schema by deriving agent first/last/email via JSON-safe and full_name fallback mapping.
2026-02-17 12:16 - Fixed 0049 refresh CTE scope bug by materializing trade_source as a temp table reused across all rollup insert statements.
2026-02-17 12:21 - Fixed 0049 search-index aggregation bug by removing aggregate output positions from GROUP BY in travel_trade_search_index inserts.
2026-02-17 11:11 - Ran quality-audit pass on travel trade rollout and updated Travel Agencies ranking layout to stack tables vertically.
2026-02-17 11:16 - Diagnosed lead/converted zero mismatch as period-definition behavior, defaulted Travel Agencies to rolling-12, and clarified leads/converted column semantics in ranking tables.
2026-02-17 11:18 - Reworked Travel Agencies landing page to revenue-first travel outcomes (default This Year) with gross revenue + traveled files prioritized in rankings and KPI context.
2026-02-17 11:21 - Diagnosed travel-trade refresh RPC failures as database statement-timeout and added migration 0050 to increase refresh function timeout to 15 minutes.
2026-02-17 11:24 - Updated Travel Agencies landing terminology from traveled files to booked files across KPI/supporting labels and ranking table headers for revenue-first clarity.
2026-02-17 11:30 - Corrected trade classification rule to consortia-present logic in refresh function source and added migration 0051 to patch live DB function + refresh.
2026-02-17 11:32 - Corrected trade classification again per business rule: consortia must be present and not any Not Applicable/null-like value; added migration 0052 to patch live function and refresh.
2026-02-17 11:37 - Completed responsive/UI audit pass across Travel Agencies landing + profile pages; fixed agency-profile 500 by restoring period_start in top-agent rollup repository query.
2026-02-17 11:38 - Completed final UI wording consistency pass by renaming landing KPI labels from travel gross profit to booked gross profit.
2026-02-17 11:50 - Aligned booked-itinerary metric to travel-period bucketing (coalesce travel_start/travel_end) via migration 0053 and updated sales profile UI labels/toggles from traveled to booked itineraries.
2026-02-17 11:54 - Hardened migration path: made 0053 idempotent/no-op safe when pattern already applied and introduced 0054 deterministic function rewrite with dedicated lead + booked-itinerary monthly rollup tables.
2026-02-17 12:03 - Finalized booked-itinerary model across API/frontend contracts (booked_itineraries sort + bookedItinerariesCount fields), refreshed metadata sources for split lead/booked rollups, and cleared all frontend build/type debt.
2026-02-17 12:08 - Fixed travel-agent operational profile data lookup by resolving contacts from external_id and querying itineraries via primary_contact_id (with fallback), restoring top-open/current-traveling results.
2026-02-17 12:11 - Improved Travel Agencies ranking table responsiveness with breakpoint-aware columns, line clamping, and reduced minimum table width to eliminate resize clipping.
2026-02-17 12:20 - Replaced agency composition bar chart with responsive vertical metrics table (gross revenue, gross profit, leads, conversion rate) and tightened travel-agent ranking table resizing on agency profile.
2026-02-17 12:26 - Completed objective audit pass for travel-trade rollout: removed unused agency composition payload path, renamed composition component to table, aligned backend/frontend/docs/contracts to split lead+booked rollups, and marked plan 12 complete.
2026-02-17 12:33 - Reorganized Command Center first-view layout with new Today’s Bookings, Today’s Snapshot, and This Week’s Snapshot cards while preserving existing KPI, briefing, and operational sections.
2026-02-17 12:39 - Simplified Command Center KPI row card UI by removing crowded status bubbles and replacing with cleaner helper text layout for improved readability/responsiveness.
2026-02-17 18:58 - Created comprehensive FX core-currency buy-timing framework action plan with deterministic decision gates, Supabase conventions, and cross-stack validation criteria.
2026-02-17 20:47 - Updated FX framework plan for USD-as-base funding, added ledger-first BUY/SPEND/ADJUSTMENT scope, and documented service signup plus expected cost tiers.
2026-02-17 20:48 - Expanded FX framework plan to require daily and on-demand macro/geopolitical intelligence orchestration with source provenance, credibility scoring, and AI analysis outputs.
2026-02-18 08:40 - Marked FX provider readiness in plan (TwelveData, OpenAI, FRED, MarketAux), confirmed testing-readiness posture, and documented deferred backup-provider approach.
2026-02-18 08:44 - Expanded FX plan for UI intelligence summaries with source links, trend highlight requirements, and explicit supplier-invoice due-date/amount weighting once invoice flow is active.
2026-02-18 09:01 - Implemented FX backend + Supabase foundation (migration 0055, expanded FX APIs/services/repository/scripts, tests scaffolding, and backend docs/payload/action-plan sync).
2026-02-18 09:25 - Applied FX hardening fixes: per-run intelligence lineage dedupe, signal prerequisite gating with skipped-run behavior, ledger currency scope validation, staleness-aware FX meta timestamps, and reconciliation patch migration 0056.
2026-02-18 09:57 - Completed second hardening pass: added FX list endpoint pagination contracts, aligned manual-run token behavior with platform safety conventions, and refreshed sample payload pagination examples.
2026-02-18 10:01 - Completed final platform audit cleanup: improved FX pagination total fallback behavior and added missing FX run/header and GET transactions/invoice-pressure sample payload contracts.
2026-02-18 10:05 - Added migration 0057 to rename FX signal-run index to column-accurate naming (`idx_fx_signal_runs_started_at`) and aligned plan index reference.
2026-02-18 10:15 - Quality audit pass on FX implementation: fixed NameError in fx_repository list_signals and list_intelligence (total_count was used but not captured from client.select).
2026-02-18 10:16 - Synced post-0057 documentation state: updated FX plan version notes, backend docs/manual-token behavior, glossary FX terms, sample payload field names, and SwainOS_BackEnd README API/config coverage.
2026-02-18 10:47 - Implemented FX frontend trading-desk update (lightweight chart + BUY/WAIT desk panels + manual refresh) and synchronized frontend docs/query inventory/sample payload notes for the expanded FX endpoint surface.
2026-02-18 11:14 - Applied audit hardening fixes to FX frontend: removed timeout bootstrap workaround via reducer-based refresh flow, preserved last-known-good panel data on partial failures, enforced payable-pair selector scope, and added accessibility pressed-state semantics.
2026-02-18 11:21 - Refactored FX command to server-side initial snapshot loading (`app/fx-command/page.tsx` + `fxServerService`) and removed mount-fetch `useEffect` from `useFxCommandData`; retained manual refresh for in-session updates.
2026-02-18 11:36 - Completed FX frontend gap-hardening pass: added server API base fallback (`API_BASE` -> `NEXT_PUBLIC_API_BASE`), enabled refresh retry from full-error state, cleaned refresh failure-state logic, and synced frontend FX query docs to SSR+manual-refresh flow.
2026-02-18 11:47 - Seeded FX desk data for chart/intelligence readiness: added historical FX backfill script (120-day daily pulls), fixed backend Decimal serialization in Supabase/OpenAI pipelines, and restored intelligence upsert dedupe to match `(run_id, source_url)` uniqueness.
2026-02-18 12:02 - Completed cross-stack quality/doc audit pass: corrected backend README FX env var names, documented new historical FX backfill script, clarified signal prerequisite-empty behavior in sample payloads, and aligned plan 13 execution status to shipped frontend scope + remaining release gates.
2026-02-18 12:11 - Added Supabase migration `0058_fix_fx_ledger_trigger_recursion.sql` to stop recursive FX ledger trigger stack overflows on `fx_transactions` writes; synced backend docs + plan migration chain notes.
2026-02-18 12:14 - Final audit pass completed after migration run: validated frontend lint/type checks, confirmed transaction endpoint UUID validation + successful writes, and renamed FX plan file to `13-fx-core-currency-buy-timing-framework-plan-completed.md`.
2026-02-18 12:23 - Implemented FX desk transaction-entry slice: added UI form for BUY/SPEND/ADJUSTMENT logging, wired frontend POST `/fx/transactions`, applied client validation/error handling with refresh-on-success, and synced frontend query/docs references.
2026-02-18 12:24 - Updated FX desk transaction entry UX to a top action button with modal pop-out form so logging remains available without consuming persistent dashboard space.
2026-02-18 12:25 - Added a prominent FX chart spot-conversion widget to surface immediate USD-to-selected-currency and reverse rate visibility for faster desk reads.
2026-02-18 12:29 - Updated FX Command refresh flow to trigger secure server-side `POST /api/v1/fx/rates/run` before reloading desk data, keeping `FX_MANUAL_RUN_TOKEN` off the client.
2026-02-18 12:36 - Consolidated frontend env configuration to `apps/web/.env.local` and removed redundant root frontend `.env` files to prevent multi-file drift and operator confusion.
2026-02-18 12:40 - Validated FX rate freshness behavior end-to-end: direct rates pull transitions `fx/rates` meta from degraded/stale to live/fresh; identified running backend process still needs restart to load manual-run token for UI refresh proxy path.
2026-02-18 12:47 - Completed cross-stack FX audit/code-review pass with clean lint/type/syntax checks, tightened frontend runbook env guidance, and shut down active frontend/backend dev servers for workspace rest.